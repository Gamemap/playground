<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"/>

<div class="container">
  <h1>Log into Ariscu</h1>
  <form id="myForm" method="POST">
    <div class="form-group">
      <input type="hidden" name="signin" value="true" />

      <label for="email">Email address</label>
      <input type="email"
             class="form-control"
             id="email"
             aria-describedby="emailHelp"
             placeholder="Enter email"
             name="email">
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input type="password"
             class="form-control"
             id="password"
             placeholder="Password"
             name="password">
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
</div>

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

<script>
  $('#myForm').submit(function(event) {
    event.preventDefault();

    $.ajax({
			type: 'POST',
			dataType: 'json',
			cache: false,
			data: {
        'email': document.getElementById('email').value,
        'password': document.getElementById('password').value,
        'signin': true
      },
			url: 'https://www.digilex.co.za/auth/login',
			success: function (response) {
        if (!isObject(response)) {
          alert('Something went wrong. Response invalid');
          return;
        }

        if (response.success) {
          window.location = 'https://www.digilex.co.za/dashboard';
          return;
        }

        alert('Login Unsuccessful. Please ensure your username/email and password is correct and your email address has been verified!');
      },
      error: function (response) {
        alert('Request failed');
      }});
  });

  function isObject(response) {
    if ((typeof response === "object") && (response !== null)) {
        return true;
    }

    return false;
  }
</script>
